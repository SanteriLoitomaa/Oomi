\chapter{Tehtävä 3 \label{chap:Teht=0000E4v=0000E4-3}}

\section{a-kohta}
\label{a-kohta}
Luokka lopputeksti sisältää intit rivimäärällä ja max merkkimäärän, sen lisäksi String Arrayn jossa on
kaikki kirjoitettava teksti. Luokassa on erikseen metodi yksittäisten rivien merkkimäärän tarkistukseen
ja koko lopputeksti olion tarkastukseen. Näiden lisäksi on mukana metodit tekstin lukemiseen ja
muokkaamiseen.
\begin{javacode}
public class Lopputeksti {
    int rivimäärä;
    int merkkimäärä;
    String[] sisältö;
    
    /**
     * Luo lopputeksti luokan ja testaa onko sen sisältämä teksti liian pitkää yms.
       ilmoittaen siitä jos näin on.
     * @.pre r = int, m = int, s String[]
     * @.post new Lopputeksti (&& Throw IndexOutOfBoundsException & virheilmoitus)
     */
    public Lopputeksti(int r, int m, String[] s) {
      this.rivimäärä=r;
      this.merkkimäärä=m;
      this.sisältö=s;
      rajoitteet(r,m,s);
    }
    /**
     * Tarkistaa ja ilmoittaa onko lopputeksti haluttujen rajojen mukaista.
     * @.pre r = int, m = int, s String[]
     * @.post (IndexOutOfBoundsException & Ilmoitus virheestä)
     */
    public void rajoitteet(int rm, int mm, String[] syöte) {
      for (int x=0;x<syöte.length;x++) {
        if (riviTarkistus(syöte[x],mm) == false) {
          try {
            throw new IndexOutOfBoundsException();
          } catch (IndexOutOfBoundsException i) {
              System.out.println("Rivillä " + x+1 + ". on liian monta merkkiä!");
          }
        }
      }
      if (rm<syöte.length) {
        try {
          throw new IndexOutOfBoundsException();
        } catch (IndexOutOfBoundsException i) {
            System.out.println("Rivejä on liikaa!");
        }
      }
    }
    /**
     * Tarkistaa rivin merkkimäärän, verraten sitä sallittuun maksimiin
     * @p.pre tarkistettava = String, maksimi = int
     * @.post return true || false
     */
    public boolean riviTarkistus(String tarkistettava, int maksimi) {
      if (tarkistettava.length()>maksimi) {
        return false;
      }
      return true;
    }
    /**
     * Muokkaa annetun rivin tekstiä
     * @.pre rivi = int, uusi = String
     * @.post sisältö[rivi] = uusi;
     */
    public void tekstinMuokkaus(int rivi, String uusi ) {
      sisältö[rivi] = uusi;
    }
    /**
     * Palauttaa annetun rivin
     * @.pre rivi = int
     * @.post return sisältö[rivi];
     */
    public String tekstinLuku(int rivi) {
      return sisältö[rivi];
    }
  }
\end{javacode}



\section{b-kohta}
\label{b-kohta}
 
Luokkaan Lopputeksti lisättiin seuraavat kaksi metodia
\begin{javacode}
/**
     * Siirtää piirrettävän tekstin y koordinaattia ja kutsuu komentoa piirrärivi
     * @.pre true
     * @.post Point c = new Point (p.x,(p.y + i*size)); &&
     *        piirräRivi(piirtopinta, canvas,c,size, i);
     */
    public void piirräTeksti(TekstiPiirtopinta piirtopinta, GraphicsContext canvas, Point p, int size) {
      for (int i = 0; i<sisältö.length;i++) {
        Point c = new Point (p.x,(p.y + i*size));
        piirräRivi(piirtopinta, canvas,c,size, i);
      }
      
    }
    /**
     * Käy annetun tekstin kirjain kirjaimelta ja muuttaa x koordinaattia sopivasti,
       kutsuen sitten drawText metodia.
     * @.pre true
     * @.post Point b = new Point ((p.x + i*size), p.y);
          piirtopinta.drawText(canvas, b, l, size);
     */
    private void piirräRivi(TekstiPiirtopinta piirtopinta, GraphicsContext canvas, Point p, int size, int row) {
      for (int i=0; i<sisältö[row].length();i++) {
        char l = sisältö[row].charAt(i);
        Point b = new Point ((p.x + i*size), p.y);
        piirtopinta.drawText(canvas, b, l, size);
      }
    }
\end{javacode}
Joiden avulla kutsutaan TextDraw metodia tekstin kirjoittamiseksi. Tämä testattiin DemoApp2 sisällä, luomalla
testiolio Tekstipiirtopinnassa ja kutsumalla sitä drawForeGrounddContent sisältä. Lopputuloksena oli valmis
teksti ruudulla.
\begin{javacode}
Point a = new Point(50,50);
testi.piirräTeksti(this, canvas, a, koko);
\end{javacode}

\section{c-kohta}
\label{c-kohta}

Metodi piirräKirjainKerralla piirtää lopputeksti olion kirjaimia yksi kerrallaan. Ja lopettaa piirtämästä
kun koko lopputeksti on päästy loppuun.
\begin{javacode}
/**
     * Metodi ottaa annetuilla luvuilla kirjaimia lopputeksteistä ja kirjoittaa ne niille kuuluville kohdille.
     * @.pre true
     * @.post piirtopinta.drawText(canvas, point, letter, size);
     */
    public void piirräKirjainKerralla(TekstiPiirtopinta piirtopinta, GraphicsContext canvas, int t, int size) {
      int x = 0;
      int a = t;
      boolean kill = false;
      while (a>=sisältö[x].length()) {
        a= a-sisältö[x].length();
        x++;
        if (x>=sisältö.length) {
          kill = true;
          break;
        }
      }
      if (kill == false) {
        char letter = sisältö[x].charAt(a);
        Point point = new Point ((a*size+50),(x*size+50));
        piirtopinta.drawText(canvas, point, letter, size);
      }
      
    }
\end{javacode}
int t määritellään tickissä ja se kasvaa jokaisella tickin kutsulla, täten se käy lopputekstit läpi
järjestyksessä. Olio itsessään luotiin tekstiGameLogicissa ja kutsuttiin tickissä.

Luonti textGameLogicissa
\begin{javacode}
  private int i = 0;
    String[] joku = new String[] {"moi","moi taas","abcdefghijklmnopqrs"};
    Lopputeksti testi = new Lopputeksti(25,10,joku);
\end{javacode}

kutsu Tickissä
\begin{javacode}
testi.piirräKirjainKerralla(piirtoPinta, piirtoPinta.getGraphicsContext2D(), i, 24);
\end{javacode}

Kussakin "sarakkessa" ts. Stringissä on vain riville kirjoitettavat merkit, joten niissä ei ole ylimääräistä,
toki jos rivin suorituksen haluaa kestävän kauemmin voi rivin loppuun lisätä välilyöntejä.
\section{d-kohta}
\label{d-kohta}

Aiemman tehtävänannon metodi ei muutu, tickissä vain lineaarisesti kasvavan i:n sijasta arvotaan se Randomia
hyväksikäyttäen. Antane lopputekstin kirjainten tulla satunnaisessa järjestyksessä.
\begin{javacode}
  Random r = new Random();
      i = r.nextInt(30);
\end{javacode}



Tekijänä Tommi Heikkinen (517749)
